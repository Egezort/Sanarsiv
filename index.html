<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sanarşiv – Dil seçin</title>
  <style>
    :root {
      color-scheme: light dark;
      --bg-light: #ffffff;
      --text-light: #202122;
      --bg-dark: #111111;
      --text-dark: #f5f5f5;
      --border-color: #ccc;
    }

    body {
      margin: 0;
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      align-items: center;
      padding: 40px 20px 60px;
      background-color: var(--bg-light);
      color: var(--text-light);
      transition: background-color 0.3s, color 0.3s;
    }

    body.dark {
      background-color: var(--bg-dark);
      color: var(--text-dark);
    }

    .container {
      max-width: 900px;
      width: 100%;
      text-align: center;
    }

    .logo img {
      max-width: 160px;
      margin-bottom: 30px;
    }

    h1 {
      font-weight: normal;
      font-size: 36px;
      margin-bottom: 40px;
    }

    .popular-langs {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 40px;
      margin-bottom: 40px;
    }

    .lang-box {
      width: 180px;
      text-align: center;
    }

    .lang-box a {
      font-size: 20px;
      color: #3366cc;
      text-decoration: none;
      display: block;
      font-weight: 500;
    }

    .lang-box a:hover {
      text-decoration: underline;
    }

    .article-count {
      font-size: 13px;
      margin-top: 4px;
    }

    .theme-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background-color: transparent;
      border: 1px solid var(--border-color);
      padding: 8px 12px;
      font-size: 14px;
      cursor: pointer;
      border-radius: 4px;
      color: inherit;
      background-color: inherit;
    }

    footer {
      font-size: 14px;
      text-align: center;
      margin-top: auto;
      padding-top: 20px;
      border-top: 1px solid var(--border-color);
      width: 100%;
      max-width: 900px;
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const translations = {
        az: {
          articleSingular: "məqalə",
          workInProgress: "İşlər davam edir",
          selectLanguageTitle: "Sanarşiv – Dil seçin",
          toggleTheme: "Mod dəyiş",
          footer: "Sanarşiv – Azad incəsənət ensiklopediyası",
          logo: "https://static.wikitide.net/sanarsivwiki/1/1f/Sanarchive_wordmark_az_%28new%29.svg"
        },
        tr: {
          articleSingular: "makale",
          workInProgress: "Çalışmalar devam ediyor",
          selectLanguageTitle: "Sanarşiv – Dil seçin",
          toggleTheme: "Temayı değiştir",
          footer: "Sanarşiv – Özgür sanat ansiklopedisi",
          logo: "https://static.wikitide.net/sanarsivwiki/7/75/Sanarchive_logo_tr_%28new%29.svg"
        },
        en: {
          articleSingular: "article",
          workInProgress: "Work In Progress",
          selectLanguageTitle: "Sanarşiv – Select language",
          toggleTheme: "Toggle theme",
          footer: "Sanarşiv – The free art encyclopedia",
          logo: "https://static.wikitide.net/sanarsivwiki/5/56/Sanarchive_logo_en_%28new%29.svg"
        }
      };

      const userLang = navigator.language || navigator.userLanguage;
      const langPrefix = userLang.substring(0, 2).toLowerCase();
      const lang = translations[langPrefix] ? langPrefix : 'en';
      document.documentElement.lang = lang;
      document.title = translations[lang].selectLanguageTitle;

      const h1 = document.querySelector('h1');
      if (h1) h1.textContent = translations[lang].selectLanguageTitle;

      const footer = document.querySelector('footer');
      if (footer) footer.textContent = translations[lang].footer;

      const logoImg = document.querySelector('.logo img');
      if (logoImg && translations[lang].logo) {
        logoImg.src = translations[lang].logo;
      }

      const langBoxes = document.querySelectorAll('.lang-box');

      langBoxes.forEach(box => {
        const link = box.querySelector('a');
        const countDiv = box.querySelector('.article-count');
        if (!link || !countDiv) return;

        const href = link.getAttribute('href');
        const match = href.match(/^https?:\/\/([a-z]{2})\.sanarsiv\.org/);
        if (!match) return;

        const code = match[1];

        if (code === 'en') {
          countDiv.textContent = "Yakında";
          return;
        }

        const apiUrl = `https://${code}.sanarsiv.org/w/api.php?action=query&meta=siteinfo&siprop=statistics&format=json&origin=*`;

        fetch(apiUrl)
          .then(response => response.json())
          .then(data => {
            const articleCount = data?.query?.statistics?.articles;
            if (articleCount && articleCount > 0) {
              countDiv.textContent = `${articleCount} ${translations[lang].articleSingular}`;
            } else {
              countDiv.textContent = translations[lang].workInProgress;
            }
          })
          .catch(() => {
            countDiv.textContent = translations[lang].workInProgress;
          });
      });

      const userPref = localStorage.getItem('theme');
      const systemPref = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      const theme = userPref || systemPref;
      document.body.classList.toggle('dark', theme === 'dark');

      const themeButton = document.getElementById('theme-toggle');
      if (themeButton) {
        themeButton.textContent = translations[lang].toggleTheme;
        themeButton.addEventListener('click', () => {
          document.body.classList.toggle('dark');
          const newTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
          localStorage.setItem('theme', newTheme);
        });
      }
    });
  </script>
</head>
<body>
  <button id="theme-toggle" class="theme-toggle">Mod dəyiş</button>

  <div class="container">
    <div class="logo">
      <img src="https://static.wikitide.net/sanarsivwiki/7/75/Sanarchive_logo_tr_%28new%29.svg" alt="Sanarşiv Logo" />
    </div>
    <h1>Sanarşiv – Dil seçin</h1>

    <div class="popular-langs" aria-label="Ən çox məqaləyə sahib olan dillər">
      <div class="lang-box">
        <a href="https://az.sanarsiv.org">Azərbaycan dili</a>
        <div class="article-count">...</div>
      </div>
      <div class="lang-box">
        <a href="https://tr.sanarsiv.org">Türkçe</a>
        <div class="article-count">...</div>
      </div>
      <div class="lang-box">
        <a href="https://en.sanarsiv.org">İngilizce</a>
        <div class="article-count">...</div>
      </div>
    </div>
  </div>

  <footer>
    Sanarşiv – Azad incəsənət ensiklopediyası
  </footer>
</body>
</html>
