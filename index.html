<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sanarşiv – Dil seçin</title>
  <style>
    /* ... önceki stiller burada aynı kalacak ... */
    :root {
      color-scheme: light dark;
      --bg-light: #fff;
      --text-light: #202122;
      --bg-dark: #111;
      --text-dark: #f5f5f5;
      --border-color: #ccc;
      --link-color: #3366cc;
      --desc-color-light: #555;
      --desc-color-dark: #aaa;
    }

    body {
      margin: 0;
      font-family: sans-serif;
      background-color: var(--bg-light);
      color: var(--text-light);
      transition: background-color 0.3s, color 0.3s;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px 60px;
    }

    body.dark {
      background-color: var(--bg-dark);
      color: var(--text-dark);
    }

    .container {
      max-width: 900px;
      width: 100%;
      text-align: center;
    }

    /* Footer ve copyright */
    footer {
      font-size: 14px;
      text-align: center;
      margin-top: auto;
      padding-top: 20px;
      border-top: 1px solid var(--border-color);
      width: 100%;
      max-width: 900px;
    }

    .copyright {
      font-size: 12px;
      color: var(--desc-color-light);
      margin-top: 6px;
    }

    body.dark .copyright {
      color: var(--desc-color-dark);
    }

    a.cc-link {
      color: var(--link-color);
      text-decoration: none;
    }
    a.cc-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <button id="theme-toggle" class="theme-toggle">Mod dəyiş</button>

  <div class="container">
    <div class="logo">
      <img src="https://static.wikitide.net/sanarsivwiki/7/75/Sanarchive_logo_tr_%28new%29.svg" alt="Sanarşiv Logo" />
    </div>
    <h1>Sanarşiv – Dil seçin</h1>

    <div class="popular-langs" aria-label="Diller">
      <div class="lang-box">
        <a href="https://az.sanarsiv.org">Azərbaycan dili</a>
        <div class="article-count">...</div>
      </div>
      <div class="lang-box">
        <a href="https://tr.sanarsiv.org">Türkçe</a>
        <div class="article-count">...</div>
      </div>
      <div class="lang-box">
        <a href="https://en.sanarsiv.org">İngilizce</a>
        <div class="article-count">...</div>
      </div>
    </div>

    <!-- Sister projects (Wikipedia style) -->
    <div class="sister-projects-box">
      <h2 id="sister-title">Kardeş projeler</h2>
      <ul class="sister-list" role="list">
        <li class="sister-item">
          <a href="https://wikidatasanarsiv.miraheze.org/" class="sister-link" target="_blank" rel="noopener">
            <img
              src="https://static.wikitide.net/sanarsivwiki/6/6a/Sandata_logo_with_wordmark.svg"
              alt="Sandata Logo"
              class="sister-icon"
              width="24"
              height="24"
              loading="lazy"
            />
            <div class="sister-text">
              <span class="sister-name">Sandata</span>
              <span class="sister-desc" id="sandata-desc">Açık kültür ve veri platformu</span>
            </div>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <footer>
    <div id="footer-text"></div>
    <div class="copyright" id="copyright-text"></div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const translations = {
        az: {
          articleSingular: "məqalə",
          workInProgress: "İşlər davam edir",
          comingSoon: "Tezliklə",
          selectLanguageTitle: "Sanarşiv – Dil seçin",
          toggleTheme: "Mod dəyiş",
          footer: "Sanarşiv – Azad incəsənət ensiklopediyası",
          logo: "https://static.wikitide.net/sanarsivwiki/1/1f/Sanarchive_wordmark_az_%28new%29.svg",
          sisterTitle: "Qardaş layihələr",
          sandataDesc: "Açıq mədəniyyət və məlumat platforması",
          copyright: 'Bu səhifə <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.tr" class="cc-link" target="_blank" rel="noopener noreferrer">Creative Commons Attribution-ShareAlike 4.0</a> lisenziyası altındadır. Yalnız Sanarşiv adı və loqosu qeydiyyatdan keçmiş markalardır.'
        },
        tr: {
          articleSingular: "makale",
          workInProgress: "Çalışmalar devam ediyor",
          comingSoon: "Yakında",
          selectLanguageTitle: "Sanarşiv – Dil seçin",
          toggleTheme: "Temayı değiştir",
          footer: "Sanarşiv – Özgür sanat ansiklopedisi",
          logo: "https://static.wikitide.net/sanarsivwiki/7/75/Sanarchive_logo_tr_%28new%29.svg",
          sisterTitle: "Kardeş projeler",
          sandataDesc: "Açık kültür ve veri platformu",
          copyright: 'Bu sayfa <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.tr" class="cc-link" target="_blank" rel="noopener noreferrer">Creative Commons Atıf-AynıLisanslaPaylaş 4.0</a> lisansı altındadır. Yalnızca Sanarşiv ismi ve logosu tescilli markalardır.'
        },
        en: {
          articleSingular: "article",
          workInProgress: "Work In Progress",
          comingSoon: "Coming soon",
          selectLanguageTitle: "Sanarşiv – Select language",
          toggleTheme: "Toggle theme",
          footer: "Sanarşiv – The free art encyclopedia",
          logo: "https://static.wikitide.net/sanarsivwiki/5/56/Sanarchive_logo_en_%28new%29.svg",
          sisterTitle: "Sister projects",
          sandataDesc: "Open culture and data platform",
          copyright: 'This page is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.tr" class="cc-link" target="_blank" rel="noopener noreferrer">Creative Commons Attribution-ShareAlike 4.0</a>. Only the Sanarşiv name and logo are registered trademarks.'
        }
      };

      const userLang = navigator.language || navigator.userLanguage || 'en';
      const langCode = userLang.substring(0, 2).toLowerCase();
      const lang = translations[langCode] ? langCode : 'en';

      document.documentElement.lang = lang;
      document.title = translations[lang].selectLanguageTitle;

      // Header title
      const h1 = document.querySelector('h1');
      if (h1) h1.textContent = translations[lang].selectLanguageTitle;

      // Footer text
      const footerText = document.getElementById('footer-text');
      if (footerText) footerText.textContent = translations[lang].footer;

      // Logo
      const logoImg = document.querySelector('.logo img');
      if (logoImg && translations[lang].logo) {
        logoImg.src = translations[lang].logo;
      }

      // Sister projects title and desc
      const sisterTitle = document.getElementById('sister-title');
      if (sisterTitle) sisterTitle.textContent = translations[lang].sisterTitle;

      const sandataDesc = document.getElementById('sandata-desc');
      if (sandataDesc) sandataDesc.textContent = translations[lang].sandataDesc;

      // Language article counts
      const langBoxes = document.querySelectorAll('.lang-box');
      langBoxes.forEach(box => {
        const link = box.querySelector('a');
        const countDiv = box.querySelector('.article-count');
        if (!link || !countDiv) return;

        const href = link.getAttribute('href');
        const match = href.match(/^https?:\/\/([a-z]{2})\.sanarsiv\.org/);
        if (!match) return;

        const code = match[1];

        if (code === 'en') {
          countDiv.textContent = translations[lang].comingSoon;
          return;
        }

        const apiUrl = `https://${code}.sanarsiv.org/w/api.php?action=query&meta=siteinfo&siprop=statistics&format=json&origin=*`;

        fetch(apiUrl)
          .then(response => response.json())
          .then(data => {
            const articleCount = data?.query?.statistics?.articles;
            if (articleCount && articleCount > 0) {
              countDiv.textContent = `${articleCount} ${translations[lang].articleSingular}`;
            } else {
              countDiv.textContent = translations[lang].workInProgress;
            }
          })
          .catch(() => {
            countDiv.textContent = translations[lang].workInProgress;
          });
      });

      // Theme toggle
      const userPref = localStorage.getItem('theme');
      const systemPref = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
      const theme = userPref || systemPref;
      document.body.classList.toggle('dark', theme === 'dark');

      const themeButton = document.getElementById('theme-toggle');
      if (themeButton) {
        themeButton.textContent = translations[lang].toggleTheme;
        themeButton.addEventListener('click', () => {
          document.body.classList.toggle('dark');
          const newTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
          localStorage.setItem('theme', newTheme);
        });
      }

      // Telif hakkı HTML olarak ekle
      const copyrightText = document.getElementById('copyright-text');
      if (copyrightText) {
        copyrightText.innerHTML = translations[lang].copyright;
      }
    });
  </script>
</body>
</html>
